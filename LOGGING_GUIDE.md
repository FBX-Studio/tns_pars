# 📊 Руководство по логам мониторинга

## Пример вывода при запуске

```
╔══════════════════════════════════════════════════════════════════════════════╗
║                    ЗАПУСК ЦИКЛА МОНИТОРИНГА                                  ║
║                         (АСИНХРОННЫЙ РЕЖИМ)                                   ║
╚══════════════════════════════════════════════════════════════════════════════╝
Время начала: 2025-01-04 15:30:45

📊 Запуск параллельного сбора из 3 источников:
   1️⃣  VK (ВКонтакте)
   2️⃣  Telegram (каналы)
   3️⃣  News (новостные сайты)

⚡ Сбор данных начат одновременно из всех источников...
```

## Этапы сбора для каждого источника

### Этап 1/4: Инициализация
```
============================================================
[VK] ЭТАП 1/4: Инициализация сбора
============================================================
[VK] ✓ Лог создан (ID: 123)
```

### Этап 2/4: Сбор данных
```
[VK] ЭТАП 2/4: Сбор данных из источника...
[VK] ✓ Получено записей: 25
```

Для NEWS видно детальный прогресс:
```
[NEWS-LIGHT] → Подключение к https://nn.ru/rss.xml
[NEWS-LIGHT] → Парсинг RSS feed...
[NEWS-LIGHT] → Найдено новостей в RSS: 50
[NEWS-LIGHT] → Фильтрация по ключевым словам...
[NEWS-LIGHT] ✓ Обработано новостей: 30/50
[NEWS-LIGHT] ✓ Релевантных (с ключевыми словами): 5
```

### Этап 3/4: Анализ и модерация
```
[VK] ЭТАП 3/4: Анализ и модерация...
[VK]   → Обработано: 5/25
[VK]   → Обработано: 10/25
[VK]   → Обработано: 15/25
[VK]   → Обработано: 20/25
[VK]   → Обработано: 25/25
```

Прогресс показывается каждые 5 записей.

### Этап 4/4: Сохранение в БД
```
[VK] ЭТАП 4/4: Сохранение в базу данных...

[VK] ============================================================
[VK] ✓ ЗАВЕРШЕНО
[VK]   Обработано: 25
[VK]   Добавлено новых: 8
[VK]   Дубликатов пропущено: 17
[VK] ============================================================
```

## Итоговые результаты

```
╔══════════════════════════════════════════════════════════════════════════════╗
║                         ИТОГОВЫЕ РЕЗУЛЬТАТЫ                                  ║
╚══════════════════════════════════════════════════════════════════════════════╝

1️⃣  VK           → ✓ Добавлено:   8 новых отзывов
2️⃣  TELEGRAM     → ✓ Добавлено:   3 новых отзыва
3️⃣  NEWS         → ✓ Добавлено:   5 новых отзывов

────────────────────────────────────────────────────────────────────────────────
📈 СТАТИСТИКА:
   • Успешных источников: 3/3
   • Ошибок: 0
   • Всего собрано: 16 новых отзывов
   • Время выполнения: 12.5 секунд
   • Завершено: 2025-01-04 15:30:57
────────────────────────────────────────────────────────────────────────────────

✅ Цикл мониторинга завершен успешно!
```

## Типы сообщений в логах

### ✓ Успех (INFO)
- Зеленый цвет в консоли
- Успешные операции
- Прогресс выполнения

### ⚠ Предупреждения (WARNING)
- Желтый цвет в консоли
- Неполные данные
- Таймауты
- Дубликаты

### ✗ Ошибки (ERROR)
- Красный цвет в консоли
- Сбои подключения
- Ошибки парсинга
- Проблемы с БД

## Примеры ошибок

### Ошибка источника
```
[TELEGRAM] ============================================================
[TELEGRAM] ✗ ОШИБКА
[TELEGRAM]   Connection timeout: Unable to connect to Telegram API
[TELEGRAM] ============================================================
```

### Ошибка в итогах
```
2️⃣  TELEGRAM     → ✗ Ошибка: Connection timeout

────────────────────────────────────────────────────────────────────────────────
📈 СТАТИСТИКА:
   • Успешных источников: 2/3
   • Ошибок: 1
   • Всего собрано: 13 новых отзывов
────────────────────────────────────────────────────────────────────────────────

✅ Цикл мониторинга завершен успешно!
```

### Полный провал
```
────────────────────────────────────────────────────────────────────────────────
📈 СТАТИСТИКА:
   • Успешных источников: 0/3
   • Ошибок: 3
   • Всего собрано: 0 новых отзывов
────────────────────────────────────────────────────────────────────────────────

⚠️  Все источники вернули ошибки!
```

## Где смотреть логи

### 1. Консоль (при ручном запуске)
```bash
python async_monitor.py
python run_collection_async.py
```

### 2. Логи веб-сервера
При запуске через `python run.py` логи выводятся в консоль.

### 3. Веб-интерфейс
http://localhost:5000/monitoring - история запусков с логами

## Настройка уровня логирования

В начале `async_monitor.py`:

```python
# Детальные логи (включая DEBUG)
logging.basicConfig(level=logging.DEBUG)

# Только важные сообщения (INFO и выше)
logging.basicConfig(level=logging.INFO)

# Только ошибки и предупреждения
logging.basicConfig(level=logging.WARNING)
```

## Интерпретация времени выполнения

| Время | Результат | Причина |
|-------|-----------|---------|
| < 10 сек | Отлично | Быстрый асинхронный сбор |
| 10-30 сек | Хорошо | Нормальная работа с данными |
| 30-60 сек | Приемлемо | Много данных или медленная сеть |
| > 60 сек | Медленно | Проблемы с сетью или таймауты |

## Что означают символы

- ✓ / ✅ - Успешно
- ✗ / ❌ - Ошибка
- ⚠️  - Предупреждение
- ℹ️  - Информация
- → - Действие в процессе
- • - Элемент списка
- 1️⃣ 2️⃣ 3️⃣ - Нумерация источников
- 📊 - Статистика
- 📈 - Результаты
- ⚡ - Быстрое действие

## Полезные команды для анализа логов

### Запуск с сохранением логов в файл (Windows PowerShell)
```powershell
python run_collection_async.py 2>&1 | Tee-Object -FilePath "logs_$(Get-Date -Format 'yyyy-MM-dd_HH-mm-ss').txt"
```

### Запуск с сохранением логов в файл (Linux/Mac)
```bash
python run_collection_async.py 2>&1 | tee logs_$(date +%Y-%m-%d_%H-%M-%S).txt
```

### Поиск ошибок в логах
```bash
grep "✗" logs.txt
grep "ERROR" logs.txt
```

### Подсчет успешных сборов
```bash
grep "✓ ЗАВЕРШЕНО" logs.txt | wc -l
```
