# Инструкция по настройке Telegram парсинга

## Данные уже настроены в .env:
```
TELEGRAM_API_ID=25079847
TELEGRAM_API_HASH=37a06d1d36fbf3879d3a81935e4b80a0
TELEGRAM_PHONE=+79103916790
```

## Шаг 1: Авторизация в Telegram

Запустите скрипт авторизации:
```bash
python setup_telegram_auth.py
```

## Что будет происходить:

1. **Подключение к Telegram API**
   - Скрипт подключится к серверам Telegram

2. **Запрос кода подтверждения**
   - Вам придёт код в Telegram на номер +79103916790
   - Введите этот код в консоль

3. **Двухфакторная аутентификация (если включена)**
   - Если у вас настроен пароль 2FA
   - Введите пароль в консоль

4. **Проверка доступа к каналам**
   - Скрипт проверит доступ к первым 5 каналам из списка
   - Покажет какие каналы доступны

5. **Создание файла сессии**
   - Создаётся файл `telegram_session.session`
   - Этот файл сохраняет авторизацию
   - Больше не нужно будет вводить код

## Шаг 2: Проверка работы

После успешной авторизации можете проверить сбор:

```bash
python -c "from collectors.telegram_user_collector import TelegramUserCollector; c = TelegramUserCollector(); messages = c.collect(); print(f'Najdeno: {len(messages)} soobshhenij')"
```

## Шаг 3: Запуск через веб-интерфейс

Теперь можно запускать через веб-приложение:

```bash
python app_enhanced.py
```

Откройте http://localhost:5000 и нажмите "Запустить сбор"

## Возможные проблемы:

### 1. "No such file or directory: telegram_session.session"
**Решение**: Запустите `python setup_telegram_auth.py` для создания сессии

### 2. "database is locked"
**Решение**: Закрыто автоматически через временные копии сессий

### 3. "Channel not found"
**Решение**: 
- Убедитесь что подписаны на эти каналы
- Проверьте правильность написания имён каналов (@moynizhny и т.д.)

### 4. Нет доступа к каналам
**Решение**:
- Откройте Telegram и подпишитесь на нужные каналы
- Запустите скрипт повторно

## Список настроенных каналов (93 шт):

Топ каналы Нижнего Новгорода:
- @moynizhny
- @bez_cenz_nn  
- @today_nn
- @nizhniy_smi
- @nn52signal
- @nn_obl
- @nnzhest
- @nn_ru
... и ещё 85 каналов

## Рекомендации:

1. **Уменьшите количество каналов** если сбор идёт долго
   - Оставьте 10-15 самых активных
   - Отредактируйте TELEGRAM_CHANNELS в .env

2. **Увеличьте период сбора** для получения большего количества сообщений
   - По умолчанию: последние 30 дней
   - Настраивается в telegram_user_collector.py

3. **Периодичность сбора**
   - Рекомендуется: раз в час
   - Telegram имеет лимиты на количество запросов

## Статус:

✅ API ID и API Hash настроены  
✅ Номер телефона настроен  
✅ Скрипт авторизации создан  
⏳ Требуется: запустить setup_telegram_auth.py для создания сессии
