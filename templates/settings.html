<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ - –¢–ù–° —ç–Ω–µ—Ä–≥–æ –ù–ù</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
            color: #1a1f36;
            line-height: 1.6;
        }
        
        /* TNS Corporate Header */
        .tns-header {
            background: #0052a5;
            color: white;
            box-shadow: 0 2px 8px rgba(0, 82, 165, 0.2);
        }
        
        .tns-top-bar {
            background: #003d7a;
            padding: 0.5rem 0;
            font-size: 0.85rem;
        }
        
        .tns-top-bar .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .tns-logo-section {
            padding: 1.2rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .tns-logo-section .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .tns-logo {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }
        
        .tns-icon {
            font-size: 2rem;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }
        
        .tns-subtitle {
            color: rgba(255, 255, 255, 0.85);
            font-size: 0.9rem;
            font-weight: 400;
            margin-left: auto;
        }
        
        /* Navigation */
        .tns-nav {
            background: #0052a5;
        }
        
        .tns-nav .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 2rem;
            display: flex;
            gap: 0;
        }
        
        .tns-nav a {
            color: white;
            text-decoration: none;
            padding: 1rem 1.5rem;
            font-weight: 500;
            font-size: 0.95rem;
            transition: all 0.2s ease;
            border-bottom: 3px solid transparent;
        }
        
        .tns-nav a:hover {
            background: rgba(255, 255, 255, 0.1);
            border-bottom-color: rgba(255, 255, 255, 0.5);
        }
        
        .tns-nav a.active {
            background: rgba(255, 255, 255, 0.15);
            border-bottom-color: #fff;
            font-weight: 600;
        }
        
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
            border: 1px solid #e3e8ee;
        }
        
        .card-header {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1a1f36;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f5f7fa;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .card-description {
            color: #697386;
            font-size: 0.95rem;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            font-weight: 600;
            color: #1a1f36;
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }
        
        .form-group .help-text {
            display: block;
            font-size: 0.85rem;
            color: #697386;
            margin-top: 0.25rem;
            line-height: 1.4;
        }
        
        .form-group input[type="text"],
        .form-group input[type="password"],
        .form-group textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #d3dce6;
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: 'Monaco', 'Courier New', monospace;
            transition: all 0.2s ease;
        }
        
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #0052a5;
            box-shadow: 0 0 0 3px rgba(0, 82, 165, 0.1);
        }
        
        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .btn {
            padding: 0.75rem 1.75rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.2s ease;
            display: inline-block;
            font-family: inherit;
        }
        
        .btn-primary {
            background: #0052a5;
            color: white;
        }
        
        .btn-primary:hover {
            background: #003d7a;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 82, 165, 0.3);
        }
        
        .btn-secondary {
            background: #697386;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #525f7f;
        }
        
        .btn-group {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
        }
        
        .alert {
            padding: 1rem 1.25rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
        }
        
        .alert-info {
            background: #e3f2fd;
            color: #0052a5;
            border: 1px solid #90caf9;
        }
        
        .alert-success {
            background: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #81c784;
        }
        
        .alert-warning {
            background: #fff3e0;
            color: #e65100;
            border: 1px solid #ffb74d;
        }
        
        .settings-section {
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid #e3e8ee;
        }
        
        .settings-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .icon {
            width: 1.25rem;
            height: 1.25rem;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="tns-header">
        <div class="tns-top-bar">
            <div class="container">
                <span>–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—Ç–∑—ã–≤–æ–≤</span>
                <span id="currentTime"></span>
            </div>
        </div>
        
        <div class="tns-logo-section">
            <div class="container">
                <div class="tns-logo">
                    <span class="tns-icon">‚ö°</span>
                    <span>–¢–ù–° —ç–Ω–µ—Ä–≥–æ –ù–ù</span>
                </div>
                <span class="tns-subtitle">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</span>
            </div>
        </div>
        
        <nav class="tns-nav">
            <div class="container">
                <a href="/">üìä –ì–ª–∞–≤–Ω–∞—è</a>
                <a href="/reviews">üí¨ –û—Ç–∑—ã–≤—ã</a>
                <a href="/monitoring">üîÑ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</a>
                <a href="/settings" class="active">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
                <a href="/help">‚ùì –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</a>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <div class="container">
        <div class="alert alert-info">
            <strong>‚ÑπÔ∏è –í–∞–∂–Ω–æ:</strong> –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª .env. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.
        </div>

        <!-- VK Settings -->
        <div class="card">
            <div class="card-header">
                <span>üì±</span>
                <span>–í–ö–æ–Ω—Ç–∞–∫—Ç–µ (VK)</span>
            </div>
            <div class="card-description">
                –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Å–±–æ—Ä–∞ –æ—Ç–∑—ã–≤–æ–≤ –∏–∑ —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏ –í–ö–æ–Ω—Ç–∞–∫—Ç–µ
            </div>
            
            <form id="vkForm">
                <div class="form-group">
                    <label for="vk_token">VK Access Token</label>
                    <input type="password" id="vk_token" name="VK_ACCESS_TOKEN" 
                           value="{{ config.VK_ACCESS_TOKEN or '' }}" 
                           placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ VK API">
                    <span class="help-text">
                        –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ <a href="https://vk.com/editapp?id=51713836&section=options" target="_blank">–Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è VK</a>. 
                        –¢—Ä–µ–±—É—é—Ç—Å—è –ø—Ä–∞–≤–∞: wall, groups, friends
                    </span>
                </div>
                
                <div class="form-group">
                    <label for="vk_groups">ID –≥—Ä—É–ø–ø VK (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                    <textarea id="vk_groups" name="VK_GROUP_IDS" placeholder="123456789,987654321">{{ config.VK_GROUP_IDS or '' }}</textarea>
                    <span class="help-text">
                        –£–∫–∞–∂–∏—Ç–µ ID –≥—Ä—É–ø–ø –í–ö–æ–Ω—Ç–∞–∫—Ç–µ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–±–µ–∑ –∑–Ω–∞–∫–∞ –º–∏–Ω—É—Å). 
                        –ù–∞–ø—Ä–∏–º–µ—Ä: 123456789,987654321
                    </span>
                </div>
            </form>
        </div>

        <!-- Telegram Settings -->
        <div class="card">
            <div class="card-header">
                <span>‚úàÔ∏è</span>
                <span>Telegram</span>
            </div>
            <div class="card-description">
                –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Å–±–æ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ Telegram –∫–∞–Ω–∞–ª–æ–≤
            </div>
            
            <form id="telegramForm">
                <div class="form-group">
                    <label for="tg_token">Telegram Bot Token</label>
                    <input type="password" id="tg_token" name="TELEGRAM_BOT_TOKEN" 
                           value="{{ config.TELEGRAM_BOT_TOKEN or '' }}" 
                           placeholder="123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11">
                    <span class="help-text">
                        –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ <a href="https://t.me/BotFather" target="_blank">@BotFather</a> –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω. 
                        –§–æ—Ä–º–∞—Ç: 123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11
                    </span>
                </div>
                
                <div class="form-group">
                    <label for="tg_api_id">Telegram API ID</label>
                    <input type="text" id="tg_api_id" name="TELEGRAM_API_ID" 
                           value="{{ config.TELEGRAM_API_ID or '' }}" 
                           placeholder="12345678">
                    <span class="help-text">
                        –ü–æ–ª—É—á–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ <a href="https://my.telegram.org/apps" target="_blank">my.telegram.org/apps</a>
                    </span>
                </div>
                
                <div class="form-group">
                    <label for="tg_api_hash">Telegram API Hash</label>
                    <input type="password" id="tg_api_hash" name="TELEGRAM_API_HASH" 
                           value="{{ config.TELEGRAM_API_HASH or '' }}" 
                           placeholder="0123456789abcdef0123456789abcdef">
                    <span class="help-text">
                        API Hash –ø–æ–ª—É—á–∞–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å API ID
                    </span>
                </div>
                
                <div class="form-group">
                    <label for="tg_channels">Telegram –∫–∞–Ω–∞–ª—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                    <textarea id="tg_channels" name="TELEGRAM_CHANNELS" placeholder="@channel1,@channel2">{{ config.TELEGRAM_CHANNELS or '' }}</textarea>
                    <span class="help-text">
                        –£–∫–∞–∂–∏—Ç–µ username –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å —Å–∏–º–≤–æ–ª–æ–º @. 
                        –ù–∞–ø—Ä–∏–º–µ—Ä: @novostinn,@nn_news
                    </span>
                </div>
            </form>
        </div>

        <!-- Keywords Settings -->
        <div class="card">
            <div class="card-header">
                <span>üîç</span>
                <span>–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞</span>
            </div>
            <div class="card-description">
                –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞ —É–ø–æ–º–∏–Ω–∞–Ω–∏–π –∫–æ–º–ø–∞–Ω–∏–∏
            </div>
            
            <form id="keywordsForm">
                <div class="form-group">
                    <label for="keywords">–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                    <textarea id="keywords" name="COMPANY_KEYWORDS" placeholder="–¢–ù–° —ç–Ω–µ—Ä–≥–æ,–¢–ù–° –ù–ù">{{ config.COMPANY_KEYWORDS|join(',') if config.COMPANY_KEYWORDS else '' }}</textarea>
                    <span class="help-text">
                        –°–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç –∏—Å–∫–∞—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏—è —ç—Ç–∏—Ö —Ñ—Ä–∞–∑. 
                        –ù–∞–ø—Ä–∏–º–µ—Ä: –¢–ù–° —ç–Ω–µ—Ä–≥–æ –ù–ù,—ç–Ω–µ—Ä–≥–æ—Å–±—ã—Ç –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥
                    </span>
                </div>
                
                <div class="form-group">
                    <label for="geo_keywords">–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)</label>
                    <textarea id="geo_keywords" name="GEO_KEYWORDS" placeholder="–ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥,–ù–ù,–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫">{{ config.GEO_KEYWORDS|join(',') if config.GEO_KEYWORDS else '' }}</textarea>
                    <span class="help-text">
                        –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ –ø–æ –≥–µ–æ–≥—Ä–∞—Ñ–∏–∏. 
                        –ù–∞–ø—Ä–∏–º–µ—Ä: –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥,–ù–ù,–ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫
                    </span>
                </div>
            </form>
        </div>

        <!-- Proxy Settings -->
        <div class="card">
            <div class="card-header">
                <span>üåê</span>
                <span>–ü—Ä–æ–∫—Å–∏ –∏ Tor</span>
            </div>
            <div class="card-description">
                –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –æ–±—Ö–æ–¥–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
            </div>
            
            <form id="proxyForm">
                <div class="form-group">
                    <label for="use_tor">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Tor</label>
                    <select id="use_tor" name="USE_TOR" style="width: 100%; padding: 0.75rem; border-radius: 8px; border: 1px solid #d3dce6;">
                        <option value="false" {{ 'selected' if not config.USE_TOR or config.USE_TOR.lower() != 'true' else '' }}>–ù–µ—Ç</option>
                        <option value="true" {{ 'selected' if config.USE_TOR and config.USE_TOR.lower() == 'true' else '' }}>–î–∞</option>
                    </select>
                    <span class="help-text">
                        –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Tor –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω Tor Browser –∏–ª–∏ Tor Service
                    </span>
                </div>
                
                <div class="form-group">
                    <label for="tor_proxy">Tor Proxy –∞–¥—Ä–µ—Å</label>
                    <input type="text" id="tor_proxy" name="TOR_PROXY" 
                           value="{{ config.TOR_PROXY or 'socks5h://127.0.0.1:9050' }}" 
                           placeholder="socks5h://127.0.0.1:9050">
                    <span class="help-text">
                        –ê–¥—Ä–µ—Å SOCKS –ø—Ä–æ–∫—Å–∏ Tor. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: socks5h://127.0.0.1:9050
                    </span>
                </div>
                
                <div class="form-group">
                    <label for="http_proxy">HTTP Proxy</label>
                    <input type="text" id="http_proxy" name="HTTP_PROXY" 
                           value="{{ config.HTTP_PROXY or '' }}" 
                           placeholder="http://proxy.example.com:8080">
                    <span class="help-text">
                        HTTP –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
                    </span>
                </div>
            </form>
        </div>

        <!-- Save Button -->
        <div class="btn-group">
            <button class="btn btn-primary" onclick="saveSettings()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <button class="btn btn-secondary" onclick="location.reload()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
        </div>
    </div>

    <script>
        // Update time
        function updateTime() {
            const now = new Date();
            document.getElementById('currentTime').textContent = now.toLocaleString('ru-RU');
        }
        setInterval(updateTime, 1000);
        updateTime();

        // Save settings
        async function saveSettings() {
            const forms = ['vkForm', 'telegramForm', 'keywordsForm', 'proxyForm'];
            const settings = {};
            
            forms.forEach(formId => {
                const form = document.getElementById(formId);
                const inputs = form.querySelectorAll('input, textarea, select');
                inputs.forEach(input => {
                    if (input.name && input.value) {
                        settings[input.name] = input.value;
                    }
                });
            });
            
            try {
                const response = await fetch('/api/settings/save', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(settings)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!\n\n–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.');
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: ' + result.message);
                }
            } catch (error) {
                alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫: ' + error.message);
            }
        }
    </script>
</body>
</html>
